"use strict";(self.webpackChunkivanignatiev=self.webpackChunkivanignatiev||[]).push([[386],{3011:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>l});var t=n(3331),i=n(4848),o=n(8453);const r={slug:"secrets-in-ds-notebooks",title:"Note 6: Manage secrets in different notebooks environments",authors:"ivanignatiev",tags:[],date:"2025-03-29T09:30"},a=void 0,c={authorsImageUrls:[void 0]},l=[{value:"Local Notebooks",id:"local-notebooks",level:2},{value:"Google Colab Secrets",id:"google-colab-secrets",level:2},{value:"Databricks",id:"databricks",level:2},{value:"Azure DevOps",id:"azure-devops",level:2}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.p,{children:["Look to tutorials for Data Engineers and Data Scientists, responses in Stackoverflow. Hardcoded credentials (",(0,i.jsx)(s.a,{href:"https://cwe.mitre.org/data/definitions/798.html",children:"CWE-798"}),", ",(0,i.jsx)(s.a,{href:"https://cwe.mitre.org/data/definitions/259.html",children:"CWE-259"}),") are everywhere, if not in code, printed in output cell. Risk to push notebook with api-keys to git or a pipeline is very high."]}),"\n",(0,i.jsx)(s.p,{children:"Static code analysis tools:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"pynblint"})," does not detect hardcoded secrets in notebook"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"bandit"})," has limited capabilities and does not fully support ",(0,i.jsx)(s.code,{children:".ipynb"})," notebooks"]}),"\n"]}),"\n",(0,i.jsx)(s.admonition,{type:"note",children:(0,i.jsxs)(s.p,{children:["I have tested bandit 1.8.3. The same code in ",(0,i.jsx)(s.code,{children:".py"})," and ",(0,i.jsx)(s.code,{children:".ipynb"})," cell. The variable with name ",(0,i.jsx)(s.code,{children:"API_KEY"})," and hardcoded value is not detected, ",(0,i.jsx)(s.code,{children:"password"})," variable is detected only in ",(0,i.jsx)(s.code,{children:".py"})," file (",(0,i.jsx)(s.a,{href:"https://bandit.readthedocs.io/en/latest/plugins/b105_hardcoded_password_string.html#b105-hardcoded-password-string",children:"B105: hardcoded_password_string"}),")."]})}),"\n",(0,i.jsx)(s.p,{children:"Anyway, the challenge for Jupyter Notebooks is possibility to have multiple natures of code in the same notebook, so Python tools are not enough:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"gitleaks"})}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"detect-secrets"})," has many false positives and need to be fine-tuned but it looks in the cell's code and output"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["More tools described in ",(0,i.jsx)(s.a,{href:"https://owasp.org/www-community/Free_for_Open_Source_Application_Security_Tools",children:"OWASP Security Tools - Secrets Detection Tools section"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"Issues can be caught during code review. However, file will be distributed across all team members PCs if merged in some shared branch."}),"\n",(0,i.jsxs)(s.p,{children:["Public services like GitHub and some serverless services (",(0,i.jsx)(s.a,{href:"https://docs.aws.amazon.com/inspector/latest/user/scanning-lambda.html",children:"Scanning AWS Lambda functions with Amazon Inspector"}),") can identify ",(0,i.jsx)(s.a,{href:"https://cwe.mitre.org/data/definitions/798.html",children:"CWE-798"})," but it does not reduce responsibilities of notebooks and code owners."]}),"\n",(0,i.jsx)(s.h2,{id:"local-notebooks",children:"Local Notebooks"}),"\n",(0,i.jsxs)(s.p,{children:["Use environment variables, or ",(0,i.jsx)(s.code,{children:"dotenv"}),", or ",(0,i.jsx)(s.code,{children:"keyring"}),", or password inputs (i.e. ",(0,i.jsx)(s.code,{children:"getpass"}),") for passwords and api keys."]}),"\n",(0,i.jsx)(s.p,{children:"Environment variables example:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"secret_in_env = os.environ['ENVIRONMENT_VARIABLE_WITH_SECRET_NAME']\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Do not print your secret variables, or ensure your cell outputs are clean before committing to ",(0,i.jsx)(s.code,{children:"git"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["If you store your secrets in ",(0,i.jsx)(s.code,{children:".env"})," file, add this file to ",(0,i.jsx)(s.code,{children:".gitignore"}),"."]}),"\n",(0,i.jsx)(s.h2,{id:"google-colab-secrets",children:"Google Colab Secrets"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"from google.colab import userdata\nsecret_in_env = userdata.get('{googleColabSecretName}')\n"})}),"\n",(0,i.jsx)(s.p,{children:"Figure. Google Colab Secrets:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Google Colab Secrets",src:n(9344).A+"",width:"3840",height:"1876"})}),"\n",(0,i.jsx)(s.h2,{id:"databricks",children:"Databricks"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"dbutils.secrets.get(scope, key)"})," for Python:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'dbutils.secrets.list(\'{databricksSecretNamespace}\')\nusername = dbutils.secrets.get(scope = "{databricksSecretNamespace}", key = "{databricksSecretName}")\n'})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"secret(scope, key)"})," for SQL queries:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"SELECT * FROM list_secrets();\nSELECT secret('{databricksSecretNamespace}', '{databricksSecretName}');\n"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/azure/databricks/security/secrets/example-secret-workflow",children:"Tutorial: Create and use a Databricks secret"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/azure/databricks/sql/language-manual/functions/secret",children:"secret function"})}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"azure-devops",children:"Azure DevOps"}),"\n",(0,i.jsx)(s.p,{children:"In MLOps, ModelOps in pipelines secrets can be stored over Variables Groups. Additionally, Variable Group can be linked to Azure KeyVault."}),"\n",(0,i.jsx)(s.p,{children:"From Variables secrets can be populated as environment variables in pipelines."}),"\n",(0,i.jsx)(s.p,{children:"Figure. Azure DevOps Variable Groups:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Azure DevOps Variable Groups",src:n(1518).A+"",width:"2540",height:"1340"})})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1518:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/azure-devops-variable-groups-d159801dc2815162886b3c2b42354a18.png"},9344:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/google-colab-secrets-287d7e8dcf22a10118a7dc1e79110a23.png"},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>a});var t=n(6540);const i={},o=t.createContext(i);function r(e){const s=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(o.Provider,{value:s},e.children)}},3331:e=>{e.exports=JSON.parse('{"permalink":"/secrets-in-ds-notebooks","source":"@site/blog/note0006-secrets-in-ds-notebooks.md","title":"Note 6: Manage secrets in different notebooks environments","description":"Look to tutorials for Data Engineers and Data Scientists, responses in Stackoverflow. Hardcoded credentials (CWE-798, CWE-259) are everywhere, if not in code, printed in output cell. Risk to push notebook with api-keys to git or a pipeline is very high.","date":"2025-03-29T09:30:00.000Z","tags":[],"readingTime":1.875,"hasTruncateMarker":false,"authors":[{"name":"Ivan Ignatiev","socials":{"x":"https://x.com/ivan_ignatiev","github":"https://github.com/ivanignatiev","linkedin":"https://www.linkedin.com/in/ivan-ignatiev/"},"imageURL":"https://github.com/ivanignatiev.png","key":"ivanignatiev","page":null}],"frontMatter":{"slug":"secrets-in-ds-notebooks","title":"Note 6: Manage secrets in different notebooks environments","authors":"ivanignatiev","tags":[],"date":"2025-03-29T09:30"},"unlisted":false,"nextItem":{"title":"Note 5: Boost Python Pipelines Speed by 3-5x","permalink":"/azure-devops-container-jobs.md"}}')}}]);